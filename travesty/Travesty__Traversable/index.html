<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Travesty__Traversable (travesty.Travesty__Traversable)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">travesty</a> &#x00BB; Travesty__Traversable</nav><h1>Module <code>Travesty__Traversable</code></h1><p>Signatures and functors for containers and data structures that can be mapped across with a monadic side-effect.</p><p>Modules based on this pattern resembles the Haskell Traversable typeclass, but with two differences:</p><ul><li>We currently define traversability in terms of monads, not applicative functors (this might change in the future, but monads are generally more well-understood and well-supported in the OCaml/Core ecosystem);</li><li>as a result, the main 'traverse' function is called <code>map_m</code>.</li></ul><nav class="toc"><ul><li><a href="#signatures">Signatures</a></li><li><a href="#making-traversable-containers">Making traversable containers</a><ul><li><a href="#new-containers">New containers</a></li><li><a href="#extending-existing-containers-with-monadic-traversals">Extending existing containers with monadic traversals</a></li></ul></li><li><a href="#combining-and-modifying-traversable-containers">Combining and modifying traversable containers</a><ul><li><a href="#chaining">Chaining</a></li><li><a href="#fixing-the-element-type">Fixing the element type</a></li></ul></li><li><a href="#helper-functions">Helper functions</a></li></ul></nav></header><section><header><h3 id="signatures"><a href="#signatures" class="anchor"></a>Signatures</h3></header><div><div class="spec include"><div class="doc"><aside><p>The main groups of signatures provided by this module are:</p><ul><li><a href="index.html#basic"><span>Basic<i>n</i></span></a>: minimal definition of new modules without an existing <code>Container</code> instance;</li><li><a href="index.html#bcon"><span>Basic<i>n</i> _container</span></a>: minimal definition of new modules with an existing <code>Container</code> instance;</li><li><a href="index.html#s"><span>S<i>n</i></span></a>: full traversable containers, produced by applying functors to either of the two groups.</li></ul><p>We also define other signatures, mostly for internal book-keeping. They may be useful elsewhere, however.</p></aside><section><header><h4 id="inner-traversal-signatures"><a href="#inner-traversal-signatures" class="anchor"></a>Inner-traversal signatures</h4><p>These signatures form the inner body of the <code>On_monad</code> functor in the main signatures. They all have names ending with <code>_on_monad</code>, and assume the existence of a monad <code>M</code>.</p><p>While they aren't interesting on their own, they do contain (in slightly abstract form) the specific functions needed to build, and provided on building, traversable containers.</p></header><section><header><h5 id="omgeneric"><a href="#omgeneric" class="anchor"></a>The generic signatures</h5><p>As with <span class="xref-unresolved" title="unresolved reference to &quot;Mappable&quot;"><span>Mappable</span></span>, we define some signatures for traversable structures in an arity-generic way, then specialise them for arity-0 and arity-1 types.</p></header><dl><dt class="spec module-type" id="module-type-Basic_generic_on_monad"><a href="#module-type-Basic_generic_on_monad" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic_generic_on_monad/index.html">Basic_generic_on_monad</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic_generic_on_monad</code> describes monadic traversal on either an arity-0 or arity-1 type.</p></dd></dl><dl><dt class="spec module-type" id="module-type-Generic_on_monad"><a href="#module-type-Generic_on_monad" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Generic_on_monad/index.html">Generic_on_monad</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Generic_on_monad</code> extends <code>Generic</code> to contain various derived operators; we use it to derive the signatures of the various <code>On_monad</code> modules.</p></dd></dl></section><section><header><h5 id="ombasic"><a href="#ombasic" class="anchor"></a>Basic signatures</h5></header><dl><dt class="spec module-type" id="module-type-Basic0_on_monad"><a href="#module-type-Basic0_on_monad" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic0_on_monad/index.html">Basic0_on_monad</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic0_on_monad</code> is the inner signature of a monadic traversal over arity-0 types.</p></dd></dl><dl><dt class="spec module-type" id="module-type-Basic1_on_monad"><a href="#module-type-Basic1_on_monad" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic1_on_monad/index.html">Basic1_on_monad</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic1_on_monad</code> is the inner signature of a monadic traversal over arity-1 types.</p></dd></dl></section><section><header><h5 id="oms"><a href="#oms" class="anchor"></a>Expanded signatures</h5></header><dl><dt class="spec module-type" id="module-type-S1_on_monad"><a href="#module-type-S1_on_monad" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S1_on_monad/index.html">S1_on_monad</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>S1_on_monad</code> extends <code>Generic_on_monad</code> with functionality that only works on arity-1 containers.</p></dd></dl></section></section><section><header><h4 id="basic-signatures"><a href="#basic-signatures" class="anchor"></a>Basic signatures</h4><p>Any traversable type can be turned into a Core container, using the monadic fold to implement all container functionality. The unified signature of a container with monadic traversals is <a href="module-type-S0/index.html"><span>S0</span></a> (arity 0) or <a href="module-type-S1/index.html"><span>S1</span></a> (arity 1).</p><p>To satisfy these signatures for new types, implement <a href="module-type-Basic0/index.html"><span>Basic0</span></a> or <a href="module-type-Basic1/index.html"><span>Basic1</span></a>, and use the corresponding <code>MakeN</code> functor.</p><p>For types that are _already_ Core containers, or types where custom implementation of the Core signature are desired, implement <a href="module-type-Basic0_container/index.html"><span>Basic0_container</span></a> or <a href="module-type-Basic1_container/index.html"><span>Basic1_container</span></a>, and use the <code>MakeN_container</code> functors.</p></header><section><header><h5 id="basic"><a href="#basic" class="anchor"></a>For modules without a <code>Container</code> implementation</h5></header><dl><dt class="spec module-type" id="module-type-Basic0"><a href="#module-type-Basic0" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic0/index.html">Basic0</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic0</code> is the minimal signature that traversable containers of arity 0 must implement to be extensible into <a href="module-type-S0/index.html"><span>S0</span></a>.</p></dd></dl><dl><dt class="spec module-type" id="module-type-Basic1"><a href="#module-type-Basic1" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic1/index.html">Basic1</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic1</code> is the minimal signature that traversable containers of arity 1 must implement to be extensible into.</p></dd></dl></section><section><header><h5 id="bcon"><a href="#bcon" class="anchor"></a>For modules with a <code>Container</code> implementation</h5></header><dl><dt class="spec module-type" id="module-type-Basic0_container"><a href="#module-type-Basic0_container" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic0_container/index.html">Basic0_container</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic0_container</code> combines <a href="module-type-Basic0/index.html"><span>Basic0</span></a> and the Base container signature, and is used for extending existing containers into <span class="xref-unresolved" title="unresolved reference to &quot;S0_container&quot;"><span>S0_container</span></span> s.</p></dd></dl><dl><dt class="spec module-type" id="module-type-Basic1_container"><a href="#module-type-Basic1_container" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Basic1_container/index.html">Basic1_container</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Basic1_container</code> combines <a href="module-type-Basic1/index.html"><span>Basic1</span></a> and the Base container signature, and is used for extending existing containers into <span class="xref-unresolved" title="unresolved reference to &quot;S1_container&quot;"><span>S1_container</span></span> s.</p></dd></dl></section></section><section><header><h4 id="s"><a href="#s" class="anchor"></a>Signatures for traversable containers</h4></header><dl><dt class="spec module-type" id="module-type-Generic"><a href="#module-type-Generic" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Generic/index.html">Generic</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>Generic</code> is a generic interface for traversable containers, used to build <code>S0</code> (arity-0) and <code>S1</code> (arity-1).</p></dd></dl><dl><dt class="spec module-type" id="module-type-S0"><a href="#module-type-S0" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S0/index.html">S0</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>S0</code> is a generic interface for arity-0 traversable containers.</p></dd></dl><dl><dt class="spec module-type" id="module-type-S1"><a href="#module-type-S1" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S1/index.html">S1</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>S1</code> is a generic interface for arity-1 traversable containers. It also includes the extensions from <span class="xref-unresolved" title="unresolved reference to &quot;Mappable&quot;"><span>Mappable</span></span>.</p></dd></dl></section></div></div></div></section><section><header><h3 id="making-traversable-containers"><a href="#making-traversable-containers" class="anchor"></a>Making traversable containers</h3><p>Monadic traversal is sufficient to define <code>fold</code>, and, therefore, all of the key functionality for a Base-style container. As such, our signatures and functors subsume those for building containers.</p></header><section><header><h4 id="new-containers"><a href="#new-containers" class="anchor"></a>New containers</h4></header><dl><dt class="spec module" id="module-Make0"><a href="#module-Make0" class="anchor"></a><code><span class="keyword">module</span> <a href="Make0/index.html">Make0</a> : <span class="keyword">functor</span> (<a href="Make0/argument-1-I/index.html">I</a> : <a href="index.html#module-type-Basic0">Basic0</a>) <span>&#45;&gt;</span> <a href="index.html#module-type-S0">S0</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="Make0/Elt/index.html">Elt</a> = <a href="Make0/argument-1-I/index.html#module-Elt">I.Elt</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="Make0/index.html#type-t">t</a> = <a href="Make0/argument-1-I/index.html#type-t">I.t</a></code></dt><dd><p><code>Make</code> makes an <a href="module-type-S0/index.html"><span>S0</span></a> from a <a href="module-type-Basic0/index.html"><span>Basic0</span></a>.</p></dd></dl><dl><dt class="spec module" id="module-Make1"><a href="#module-Make1" class="anchor"></a><code><span class="keyword">module</span> <a href="Make1/index.html">Make1</a> : <span class="keyword">functor</span> (<a href="Make1/argument-1-I/index.html">I</a> : <a href="index.html#module-type-Basic1">Basic1</a>) <span>&#45;&gt;</span> <a href="index.html#module-type-S1">S1</a> <span class="keyword">with</span> <span class="keyword">type</span> 'a <a href="Make1/index.html#type-t">t</a> = <span class="type-var">'a</span> <a href="Make1/argument-1-I/index.html#type-t">I.t</a></code></dt><dd><p><code>Make</code> makes an <a href="module-type-S1/index.html"><span>S1</span></a> from a <a href="module-type-Basic1/index.html"><span>Basic1</span></a>.</p></dd></dl></section><section><header><h4 id="extending-existing-containers-with-monadic-traversals"><a href="#extending-existing-containers-with-monadic-traversals" class="anchor"></a>Extending existing containers with monadic traversals</h4></header><dl><dt class="spec module" id="module-Make0_container"><a href="#module-Make0_container" class="anchor"></a><code><span class="keyword">module</span> <a href="Make0_container/index.html">Make0_container</a> : <span class="keyword">functor</span> (<a href="Make0_container/argument-1-I/index.html">I</a> : <a href="index.html#module-type-Basic0_container">Basic0_container</a>) <span>&#45;&gt;</span> <a href="index.html#module-type-S0">S0</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="Make0_container/Elt/index.html">Elt</a> = <a href="Make0_container/argument-1-I/index.html#module-Elt">I.Elt</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="Make0_container/index.html#type-t">t</a> = <a href="Make0_container/argument-1-I/index.html#type-t">I.t</a></code></dt><dd><p><code>Make0_container</code> makes an <a href="module-type-S0/index.html"><span>S0</span></a> from a <a href="module-type-Basic0_container/index.html"><span>Basic0_container</span></a>.</p></dd></dl><dl><dt class="spec module" id="module-Make1_container"><a href="#module-Make1_container" class="anchor"></a><code><span class="keyword">module</span> <a href="Make1_container/index.html">Make1_container</a> : <span class="keyword">functor</span> (<a href="Make1_container/argument-1-I/index.html">I</a> : <a href="index.html#module-type-Basic1_container">Basic1_container</a>) <span>&#45;&gt;</span> <a href="index.html#module-type-S1">S1</a> <span class="keyword">with</span> <span class="keyword">type</span> 'a <a href="Make1_container/index.html#type-t">t</a> = <span class="type-var">'a</span> <a href="Make1_container/argument-1-I/index.html#type-t">I.t</a></code></dt><dd><p><code>Make1_container</code> makes an <a href="module-type-S1/index.html"><span>S1</span></a> from a <span class="xref-unresolved" title="unresolved reference to &quot;Basic_container1&quot;"><span>Basic1_container</span></span>.</p></dd></dl></section></section><section><header><h3 id="combining-and-modifying-traversable-containers"><a href="#combining-and-modifying-traversable-containers" class="anchor"></a>Combining and modifying traversable containers</h3></header><section><header><h4 id="chaining"><a href="#chaining" class="anchor"></a>Chaining</h4></header><dl><dt class="spec module" id="module-Chain0"><a href="#module-Chain0" class="anchor"></a><code><span class="keyword">module</span> <a href="Chain0/index.html">Chain0</a> : <span class="keyword">functor</span> (<a href="Chain0/argument-1-Outer/index.html">Outer</a> : <a href="index.html#module-type-S0">S0</a>) <span>&#45;&gt;</span> <span class="keyword">functor</span> (<a href="Chain0/argument-2-Inner/index.html">Inner</a> : <a href="index.html#module-type-S0">S0</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="Chain0/index.html#type-t">t</a> := <a href="Chain0/argument-1-Outer/index.html#module-Elt">Outer.Elt</a>.t) <span>&#45;&gt;</span> <a href="index.html#module-type-S0">S0</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="Chain0/Elt/index.html">Elt</a> = <a href="Chain0/argument-2-Inner/index.html#module-Elt">Inner.Elt</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="Chain0/index.html#type-t">t</a> = <a href="Chain0/argument-1-Outer/index.html#type-t">Outer.t</a></code></dt><dd><p><code>Chain0</code> chains two <a href="module-type-S0/index.html"><span>S0</span></a> instances together, traversing each element of the outer instance with the inner instance.</p></dd></dl></section><section><header><h4 id="fixing-the-element-type"><a href="#fixing-the-element-type" class="anchor"></a>Fixing the element type</h4></header><dl><dt class="spec module" id="module-Fix_elt"><a href="#module-Fix_elt" class="anchor"></a><code><span class="keyword">module</span> <a href="Fix_elt/index.html">Fix_elt</a> : <span class="keyword">functor</span> (<a href="Fix_elt/argument-1-I/index.html">I</a> : <a href="index.html#module-type-S1">S1</a>) <span>&#45;&gt;</span> <span class="keyword">functor</span> (<a href="Fix_elt/index.html#argument-2-Elt">Elt</a> : Base.Equal.S) <span>&#45;&gt;</span> <a href="index.html#module-type-S0">S0</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="Fix_elt/Elt/index.html">Elt</a> = <a href="Fix_elt/index.html#argument-2-Elt">Elt</a> <span class="keyword">and</span> <span class="keyword">type</span> <a href="Fix_elt/index.html#type-t">t</a> = <a href="Fix_elt/index.html#argument-2-Elt">Elt</a>.t <a href="Fix_elt/argument-1-I/index.html#type-t">I.t</a></code></dt><dd><p><code>Fix_elt (I) (Elt)</code> demotes an <a href="module-type-S1/index.html"><span>S1</span></a> <code>S</code> to an <a href="module-type-S0/index.html"><span>S0</span></a> by fixing the element type to that mentioned in <code>Elt</code>.</p></dd></dl></section></section><section><header><h3 id="helper-functions"><a href="#helper-functions" class="anchor"></a>Helper functions</h3></header><dl><dt class="spec module" id="module-Helpers"><a href="#module-Helpers" class="anchor"></a><code><span class="keyword">module</span> <a href="Helpers/index.html">Helpers</a> : <span class="keyword">functor</span> (<a href="Helpers/index.html#argument-1-M">M</a> : Base.Monad.S) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Utility functions for building traversals.</p></dd></dl></section></div></body></html>